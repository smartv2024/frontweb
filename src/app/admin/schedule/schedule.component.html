<div class="mt-4">
  <!-- Header Section -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fas fa-calendar-alt me-2"></i>Schedule List</h2>
    <div class="d-flex gap-2">
      <button class="btn btn-primary btn-sm" routerLink="/admin/Devices">
        <i class="fas fa-plus-circle me-1"></i> New Schedule
      </button>
      <a class="btn btn-warning btn-sm" href="https://cloud.perfumatic.es/login">
        <i class="fas fa-cloud me-1"></i> Perfumatic
      </a>
    </div>
  </div>

  <!-- Cards Section - Smaller Cards, More per Row -->
  <div class="row row-cols-1 row-cols-md-3 row-cols-lg-4 row-cols-xl-5 g-3">
    <div class="col" *ngFor="let schedule of paginatedSchedules">
      <div class="schedule-card h-100">
        <div class="schedule-card-header">
          <h6 class="mb-0 text-truncate" title="{{ schedule.deviceId.name }}">
            <i class="fas fa-tv me-2"></i>{{ schedule.deviceId.name }}
          </h6>
        </div>
        <div class="schedule-card-body">
          <div class="info-item">
            <span class="info-label"><i class="fas fa-film me-1"></i> Ads:</span>
            <span class="info-value">{{ schedule.advertisementIds.length }}</span>
          </div>
          <div class="info-item">
            <span class="info-label"><i class="fas fa-play-circle me-1"></i> Current:</span>
            <span class="info-value text-truncate" title="{{ schedule.instantData?.titleVideo || 'Waiting...' }}">
              {{ schedule.instantData?.titleVideo || 'Waiting...' }}
            </span>
          </div>
          
          <!-- Compact God's Eye Section -->
          <div class="gods-eye-section">
            <div class="section-title">
              <i class="fas fa-eye me-1"></i> Status Monitor
            </div>
            <div class="d-flex align-items-center justify-content-between mt-2">
              <span title="App Status">
                <i class="fas fa-circle status-dot" [ngClass]="getAppStateColor(appState, schedule.deviceId.deviceId)"></i>
                <i class="fas fa-mobile-alt me-1"></i> App
              </span>
              <span title="Playlist Status" *ngIf="schedule.instantData">
                <i class="fas fa-circle status-dot" [ngClass]="getPlaylistColor(schedule, schedule.deviceId.deviceId)"></i>
                <i class="fas fa-list me-1"></i> #{{ schedule.instantData?.index || '' }}
              </span>
              <span title="Playlist Status" *ngIf="!schedule.instantData">
                <i class="fas fa-circle status-dot" [ngClass]="getPlaylistColor(schedule, schedule.deviceId.deviceId)"></i>
                <i class="fas fa-list me-1"></i> N/A
              </span>
            </div>
            <div class="status-message" [ngClass]="{
              'text-success': deviceLogs[schedule.deviceId.deviceId] === 'All Good!' || deviceLogs[schedule.deviceId.deviceId] === 'Playlist updated',
              'text-danger': deviceLogs[schedule.deviceId.deviceId] !== 'All Good!'
            }">
              <i class="fas fa-info-circle me-1"></i>
              {{ deviceLogs[schedule.deviceId.deviceId] || 'No status' }}
            </div>
          </div>
        </div>
        <div class="schedule-card-footer">
          <button class="action-btn view-btn" (click)="viewSchedule(schedule._id)" title="View Schedule">
            <i class="fas fa-eye"></i>
          </button>
        
         
          <button class="action-btn delete-btn" (click)="deleteSchedule(schedule._id)" title="Delete Schedule">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Pagination Controls -->
  <div class="pagination-controls mt-4">
    <button class="prev-button" (click)="previousPage()" [disabled]="pageIndex === 0">
      <i class="fas fa-chevron-left me-1"></i> Previous
    </button>
    <span><i class="fas fa-file-alt me-1"></i> Page {{ pageIndex + 1 }} of {{ totalPages }}</span>
    <button class="next-button" (click)="nextPage()" [disabled]="pageIndex >= totalPages - 1">
      Next <i class="fas fa-chevron-right ms-1"></i>
    </button>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="text-center mt-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2"><i class="fas fa-hourglass-half me-1"></i> Loading schedules...</p>
  </div>

  <!-- No Schedules Found -->
  <div *ngIf="!loading && schedules.length === 0" class="text-center mt-4">
    <i class="fas fa-calendar-times fa-3x mb-3 text-muted"></i>
    <p>No schedules found.</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-danger mt-4" role="alert">
    <i class="fas fa-exclamation-triangle me-2"></i> {{ error }}
  </div>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel"><i class="fas fa-eye me-2"></i>God's Eye View</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title"><i class="fas fa-server me-2"></i>Device Log</h5>
                  <p class="card-text">{{ deviceLogs[selectedDeviceId] || 'No log available' }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="fas fa-times me-1"></i> Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
