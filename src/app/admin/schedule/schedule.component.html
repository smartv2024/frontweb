<div class="mt-4">
  <!-- Table Section -->
  <div class="table-responsive">
    <table class="table table-hover table-striped">
      <thead class="table-dark">
        <tr>
          <th style="width: 20%;">Device</th>
          <th style="width: 8%;">Ads</th>
          <th style="width: 30%;">Current Video</th>
          <th style="width: 10%;">App Status</th>
          <th style="width: 10%;">Playlist</th>
          <th style="width: 30%;">Status Message</th>
          <th style="width: 13%;">Actions   <button class="btn btn-primary btn-sm" routerLink="/admin/Devices" title="New Schedule">
                <i class="fas fa-plus-circle"></i>
              </button> </th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let schedule of paginatedSchedules">
          <td>
            <div class="d-flex align-items-center">
              <i class="fas fa-tv me-2 text-primary"></i>
              <span class="fw-medium" title="{{ schedule.deviceId.name }}" style="white-space: nowrap;">
                {{ schedule.deviceId.name }}
              </span>
            </div>
          </td>
          <td class="text-center">
            <span class="badge bg-info">{{ schedule.advertisementIds.length }}</span>
          </td>
          <td>
            <span class="d-block" title="{{ schedule.instantData?.titleVideo || 'Waiting...' }}" style="white-space: nowrap;">
              <i class="fas fa-play-circle me-1 text-success"></i>
              {{ schedule.instantData?.titleVideo || 'Waiting...' }}
            </span>
          </td>
          <td class="text-center">
            <div class="d-flex align-items-center justify-content-center">
              <i class="fas fa-circle status-dot me-2" [ngClass]="getAppStateColor(appState, schedule.deviceId.deviceId)"></i>
              <i class="fas fa-mobile-alt"></i>
            </div>
          </td>
          <td class="text-center">
            <div class="d-flex align-items-center justify-content-center">
              <i class="fas fa-circle status-dot me-2" [ngClass]="getPlaylistColor(schedule, schedule.deviceId.deviceId)"></i>
              <span>#{{ schedule.instantData?.index || 'N/A' }}</span>
            </div>
          </td>
          <td>
            <span class="status-message-text" style="white-space: nowrap;" [ngClass]="{
              'text-success': deviceLogs[schedule.deviceId.deviceId] === 'All Good!' || deviceLogs[schedule.deviceId.deviceId] === 'Playlist updated',
              'text-danger': deviceLogs[schedule.deviceId.deviceId] !== 'All Good!' && deviceLogs[schedule.deviceId.deviceId] !== 'Playlist updated'
            }">
              <i class="fas fa-info-circle me-1"></i>
              {{ deviceLogs[schedule.deviceId.deviceId] || 'No status' }}
            </span>
          </td>
          <td>
            <div class="d-flex gap-1 justify-content-center">
            
              <button class="btn btn-outline-primary btn-sm" (click)="viewSchedule(schedule._id)" title="View Schedule">
                <i class="fas fa-eye"></i>
              </button>
              <button class="btn btn-outline-danger btn-sm" (click)="deleteSchedule(schedule._id)" title="Delete Schedule">
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Enhanced Pagination Controls -->
  <div class="pagination-controls mt-4">
    <button class="prev-button" (click)="previousPage()" [disabled]="pageIndex === 0">
      <i class="fas fa-chevron-left me-1"></i> Previous
    </button>
    <span><i class="fas fa-file-alt me-1"></i> Page {{ pageIndex + 1 }} of {{ totalPages }}</span>
    <button class="next-button" (click)="nextPage()" [disabled]="pageIndex >= totalPages - 1">
      Next <i class="fas fa-chevron-right ms-1"></i>
    </button>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="loading" class="text-center mt-4">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2"><i class="fas fa-hourglass-half me-1"></i> Loading schedules...</p>
  </div>

  <!-- No Schedules Found -->
  <div *ngIf="!loading && schedules.length === 0" class="text-center mt-4">
    <i class="fas fa-calendar-times fa-3x mb-3 text-muted"></i>
    <p>No schedules found.</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert alert-danger mt-4" role="alert">
    <i class="fas fa-exclamation-triangle me-2"></i> {{ error }}
  </div>

  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel"><i class="fas fa-eye me-2"></i>God's Eye View</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6 mb-3">
              <div class="card">
                <div class="card-body">
                  <h5 class="card-title"><i class="fas fa-server me-2"></i>Device Log</h5>
                  <p class="card-text">{{ deviceLogs[selectedDeviceId] || 'No log available' }}</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="fas fa-times me-1"></i> Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
