
<div class="page-container">
  <div class="content-wrapper">
    <!-- Header Section -->
    <div class="page-header">
      <h1 class="page-title">Add New Advertisement</h1>
      <p class="page-subtitle">Upload and configure your advertisement details</p>
    </div>

<div class="container card pt-5 mt-5 shadow">
  <form #advertisementForm="ngForm">
    <!-- Existing video source selection -->
    <div class="form-group">
      <label for="videoSource">
        <i class="fas fa-film me-2"></i>Video Source
      </label>
      <select
        id="videoSource"
        class="form-control"
        [(ngModel)]="selectedVideoSource"
        name="videoSource"
        required
      >
        <option value="local" selected>Upload from Computer</option>
     <!--   <option value="youtube">YouTube Video</option> -->
      </select>
    </div>

    <!-- Local File Upload -->
    <div class="form-group" *ngIf="selectedVideoSource === 'local'">
      <label for="videoFile" class="file-upload-label">
        <i class="fas fa-cloud-upload-alt me-2"></i>Choose Video File
      </label>
      <input
        type="file"
        id="videoFile"
        accept="video/*"
        (change)="onFileSelected($event)"
        #fileInput
      >
      <small class="text-muted d-block">Maximum file size: 100MB</small>
      <div *ngIf="selectedFile" class="mt-2">
        <span class="text-success">Selected file: {{ selectedFile.name }}</span>
      </div>
    </div>

    <!-- YouTube URL -->
    <div class="form-group" *ngIf="selectedVideoSource === 'youtube'">
      <label for="youtubeUrl">
        <i class="fab fa-youtube me-2"></i>YouTube Video URL
      </label>
      <div class="input-group">
        <input
          type="text"
          id="youtubeUrl"
          class="form-control"
          [(ngModel)]="youtubeUrl"
          name="youtubeUrl"
          placeholder="Enter YouTube URL"
          required
        >
       
      </div>
      
      <!-- Quality selector for YouTube videos -->
      <div *ngIf="showQualitySelector && availableQualities.length > 0" class="mt-3">
        <label for="quality">Select Video Quality:</label>
        <select
          id="quality"
          class="form-control"
          [(ngModel)]="selectedQuality"
          (ngModelChange)="onQualitySelected()"
          name="quality"
        >
          <option value="">Choose quality</option>
          <option *ngFor="let quality of availableQualities" [value]="quality.quality">
            {{ quality.quality }}p
          </option>
        </select>
      </div>
    </div>

    <!-- Upload Progress and Messages -->
    <div class="mt-3">
      <!-- Progress Bar -->
      <div class="progress mb-2" *ngIf="isUploading">
        <div 
          class="progress-bar progress-bar-striped progress-bar-animated" 
          role="progressbar" 
          [style.width.%]="uploadProgress"
          [attr.aria-valuenow]="uploadProgress" 
          aria-valuemin="0" 
          aria-valuemax="100"
        >
          {{uploadProgress}}%
        </div>
      </div>

      <!-- Success Message -->
      <div class="alert alert-success alert-dismissible fade show" role="alert" *ngIf="successMessage">
        <i class="fas fa-check-circle me-2"></i>{{ successMessage }}
        <button type="button" class="btn-close" (click)="successMessage = ''"></button>
      </div>

      <!-- Error Message -->
      <div class="alert alert-danger alert-dismissible fade show" role="alert" *ngIf="errorMessage">
        <i class="fas fa-exclamation-circle me-2"></i>{{ errorMessage }}
        <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
      </div>
    </div>

    <!-- Upload Button -->
    <div class="mt-3">
      <button 
        class="btn btn-primary upload-btn" 
        (click)="uploadVideo()" 
        [disabled]="isUploading || (!selectedFile && !youtubeUrl)"
      >
        <i class="fas" [ngClass]="isUploading ? 'fa-spinner fa-spin' : 'fa-upload'"></i>
        <span class="ms-2">{{ isUploading ? 'Uploading...' : 'Upload Video' }}</span>
      </button>
      
      <!-- Progress bar -->
      <div class="progress mt-3" *ngIf="isUploading">
        <div 
          class="progress-bar" 
          role="progressbar" 
          [style.width.%]="uploadProgress"
          [attr.aria-valuenow]="uploadProgress" 
          aria-valuemin="0" 
          aria-valuemax="100"
        >
          {{uploadProgress}}%
        </div>
      </div>
    </div>

    <!-- Rest of the form fields (only enabled after video processing) -->
    <div [class.disabled-form]="!isVideoProcessed">
      <!-- Name -->
      <div class="form-group">
        <label for="name">
          <i class="fas fa-tag me-2"></i>Advertisement Name
        </label>
        <input
          type="text"
          id="name"
          class="form-control"
          [(ngModel)]="advertisementObject.name"
          name="name"
          required
          [disabled]="!isVideoProcessed"
        >
      </div>

      <!-- Description -->
      <div class="form-group">
        <label for="description">
          <i class="fas fa-align-left me-2"></i>Description
        </label>
        <textarea
          id="description"
          class="form-control"
          [(ngModel)]="advertisementObject.description"
          name="description"
          required
          [disabled]="!isVideoProcessed"
        ></textarea>
      </div>

      <!-- Orientation -->
      <div class="form-group">
        <label for="orientation">
          <i class="fas fa-mobile-alt me-2"></i>Orientation
        </label>
        <select
          id="orientation"
          class="form-control"
          [(ngModel)]="advertisementObject.orientation"
          name="orientation"
          required
          [disabled]="!isVideoProcessed"
        >
          <option value="">Select orientation</option>
          <option *ngFor="let orientation of orientations" [value]="orientation">
            {{orientation}}
          </option>
        </select>
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        class="btn btn-success mt-3"
        (click)="addAdvertisement()"
        [disabled]="!isVideoProcessed || isSubmitting || !advertisementForm.form.valid"
      >
        <i class="fas fa-save me-2"></i>
        {{isSubmitting ? 'Saving...' : 'Save Advertisement'}}
      </button>
    </div>
  </form>
</div>
  
