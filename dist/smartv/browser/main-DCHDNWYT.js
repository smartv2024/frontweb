import{A as Y,Aa as j,B as r,C as i,D as g,G as N,H as h,I as y,Ia as D,K as A,Ka as ae,L as s,N as S,Na as se,P as _,Pa as de,Q as v,R as M,Wa as pe,_ as L,da as Q,ea as X,fa as $,ha as ee,ia as te,j as O,ja as ne,k as I,ka as oe,l as J,m as l,ma as re,n as m,na as P,qa as Z,r as a,ra as ie,s as w,sa as f,t as b,u as k,ua as E,v as C,wa as T,x as c,xa as V,ya as R,za as F}from"./chunk-QCLMKNWM.js";function ue(e,o){if(e&1&&(r(0,"div",13),s(1),i()),e&2){let n=y();a(),S(" ",n.errorMessage," ")}}function fe(e,o){e&1&&(r(0,"span"),s(1,"Login"),i())}function he(e,o){e&1&&g(0,"div",14)}var H=class e{constructor(o,n){this.authService=o;this.router=n}username="";password="";errorMessage="";isLoading=!1;onSubmit(){this.isLoading=!0,this.errorMessage="",this.authService.login({username:this.username,password:this.password}).subscribe({next:o=>{this.isLoading=!1,this.authService.forcePasswordChange?this.router.navigate(["/change-password"]):this.router.navigate(["/admin"])},error:o=>{this.isLoading=!1,o.status===403?this.errorMessage="Your account is inactive. Please contact administrator.":this.errorMessage=o.error?.message||"An error occurred during login"}})}static \u0275fac=function(n){return new(n||e)(w(f),w(P))};static \u0275cmp=b({type:e,selectors:[["app-login"]],standalone:!1,decls:18,vars:6,consts:[["loginForm","ngForm"],[1,"login-container"],[1,"form-container"],[3,"ngSubmit"],["class","error-message",4,"ngIf"],[1,"form-group"],["for","email"],["id","email","type","text","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password"],["id","password","type","password","name","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn-submit",3,"disabled"],[4,"ngIf"],["class","spinner",4,"ngIf"],[1,"error-message"],[1,"spinner"]],template:function(n,t){if(n&1){let p=N();r(0,"div",1)(1,"div",2)(2,"h2"),s(3,"Login"),i(),r(4,"form",3,0),h("ngSubmit",function(){return l(p),m(t.onSubmit())}),C(6,ue,2,1,"div",4),r(7,"div",5)(8,"label",6),s(9,"Email:"),i(),r(10,"input",7),M("ngModelChange",function(d){return l(p),v(t.username,d)||(t.username=d),m(d)}),i()(),r(11,"div",5)(12,"label",8),s(13,"Password:"),i(),r(14,"input",9),M("ngModelChange",function(d){return l(p),v(t.password,d)||(t.password=d),m(d)}),i()(),r(15,"button",10),C(16,fe,2,0,"span",11)(17,he,1,0,"div",12),i()()()()}if(n&2){let p=A(5);a(6),c("ngIf",t.errorMessage),a(4),_("ngModel",t.username),a(4),_("ngModel",t.password),a(),c("disabled",!p.form.valid||t.isLoading),a(),c("ngIf",!t.isLoading),a(),c("ngIf",t.isLoading)}},dependencies:[L,j,E,T,V,D,F,R],styles:['.login-container[_ngcontent-%COMP%]{background:url("./media/smartTVPR-5SJUNIVB.jpg") no-repeat center center/cover;position:fixed;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:#0009;background-blend-mode:darken}.form-container[_ngcontent-%COMP%]{background:#ffffff26;-webkit-backdrop-filter:blur(15px);backdrop-filter:blur(15px);border-radius:15px;box-shadow:0 4px 10px #0009;padding:30px 40px;width:100%;max-width:400px;text-align:center;color:#fff}.form-group[_ngcontent-%COMP%]{margin-bottom:20px;text-align:left}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:1rem;margin-bottom:5px;color:#fff}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;font-size:1rem;background-color:#fffc;color:#333}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#999}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid #f3f3f3;border-top:2px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.btn-submit[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;min-width:80px;min-height:36px;background:#007bff;color:#fff;border:none;padding:10px 15px;border-radius:5px;font-size:1rem;cursor:pointer;transition:background-color .3s ease}.btn-submit[_ngcontent-%COMP%]:hover{background:#0056b3}@media (max-width: 768px){.form-container[_ngcontent-%COMP%]{padding:20px}}']})};function we(e,o){e&1&&g(0,"span",23)}function be(e,o){if(e&1&&(r(0,"div",24),s(1),i()),e&2){let n=y();a(),S(" ",n.errorMessage," ")}}function Ce(e,o){if(e&1&&(r(0,"div",25),s(1),i()),e&2){let n=y();a(),S(" ",n.successMessage," ")}}var z=class e{constructor(o,n){this.authService=o;this.router=n}currentPassword="";newPassword="";confirmPassword="";isLoading=!1;errorMessage="";successMessage="";showCurrentPassword=!1;showNewPassword=!1;ngOnInit(){}validateForm(){return!this.currentPassword||!this.newPassword||!this.confirmPassword?(this.errorMessage="All fields are required",!1):this.newPassword!==this.confirmPassword?(this.errorMessage="New password and confirmation do not match",!1):this.newPassword.length<8?(this.errorMessage="New password must be at least 8 characters long",!1):!0}onSubmit(){let o=this.authService.userId;if(!o){this.errorMessage="User ID not found. Please try logging in again.";return}console.log(o),this.isLoading=!0,this.errorMessage="",this.successMessage="",this.authService.changePassword({userId:o,currentPassword:this.currentPassword,newPassword:this.newPassword}).subscribe({next:n=>{this.successMessage=n.message||"Password changed successfully",this.isLoading=!1,this.currentPassword="",this.newPassword="",this.confirmPassword="",setTimeout(()=>{this.router.navigate(["/admin"])},2e3)},error:n=>{this.isLoading=!1,this.errorMessage=n.error?.message||"Failed to change password. Please try again."}})}logout(){this.authService.logout(),this.router.navigate(["/login"])}static \u0275fac=function(n){return new(n||e)(w(f),w(P))};static \u0275cmp=b({type:e,selectors:[["app-changepwd"]],standalone:!1,decls:39,vars:12,consts:[["passwordForm","ngForm"],[1,"navbar","navbar-dark","bg-dark","shadow-lg"],[1,"container"],[1,"navbar-brand"],["src","https://iili.io/2gvDOlt.th.png","width","60","height","60",1,"d-inline-block","align-text-top"],[1,"btn","btn-danger",3,"click"],[1,"fas","fa-sign-out-alt","me-2"],[1,"main-container"],[1,"change-password-card"],[1,"card-header"],[1,"security-notice"],[3,"ngSubmit"],[1,"form-group"],[1,"form-label"],[1,"input-group"],["name","currentPassword","required","",1,"form-control",3,"ngModelChange","type","ngModel"],["type","button",1,"toggle-password",3,"click"],["name","newPassword","required","",1,"form-control",3,"ngModelChange","type","ngModel"],[1,"btn-container"],["type","submit",1,"btn-submit",3,"disabled"],["class","spinner-border spinner",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],["class","alert alert-success",4,"ngIf"],[1,"spinner-border","spinner"],[1,"alert","alert-danger"],[1,"alert","alert-success"]],template:function(n,t){if(n&1){let p=N();r(0,"nav",1)(1,"div",2)(2,"a",3),g(3,"img",4),i(),r(4,"button",5),h("click",function(){return l(p),m(t.logout())}),g(5,"i",6),s(6," Logout "),i()()(),r(7,"div",7)(8,"div",8)(9,"div",9)(10,"h2"),s(11,"Change Password"),i()(),r(12,"div",10)(13,"h3"),s(14,"Security Update"),i(),r(15,"p"),s(16,"To enhance the security of your account, please change your password. Choose a strong password that you haven't used before."),i()(),r(17,"form",11,0),h("ngSubmit",function(){return l(p),m(t.onSubmit())}),r(19,"div",12)(20,"label",13),s(21,"Current Password"),i(),r(22,"div",14)(23,"input",15),M("ngModelChange",function(d){return l(p),v(t.currentPassword,d)||(t.currentPassword=d),m(d)}),i(),r(24,"button",16),h("click",function(){return l(p),m(t.showCurrentPassword=!t.showCurrentPassword)}),g(25,"i"),i()()(),r(26,"div",12)(27,"label",13),s(28,"New Password"),i(),r(29,"div",14)(30,"input",17),M("ngModelChange",function(d){return l(p),v(t.newPassword,d)||(t.newPassword=d),m(d)}),i(),r(31,"button",16),h("click",function(){return l(p),m(t.showNewPassword=!t.showNewPassword)}),g(32,"i"),i()()(),r(33,"div",18)(34,"button",19),C(35,we,1,0,"span",20),s(36," Change Password "),i()(),C(37,be,2,1,"div",21)(38,Ce,2,1,"div",22),i()()()}if(n&2){let p=A(18);a(23),c("type",t.showCurrentPassword?"text":"password"),_("ngModel",t.currentPassword),a(2),Y(t.showCurrentPassword?"fas fa-eye-slash":"fas fa-eye"),a(5),c("type",t.showNewPassword?"text":"password"),_("ngModel",t.newPassword),a(2),Y(t.showNewPassword?"fas fa-eye-slash":"fas fa-eye"),a(2),c("disabled",!p.form.valid||t.isLoading),a(),c("ngIf",t.isLoading),a(2),c("ngIf",t.errorMessage),a(),c("ngIf",t.successMessage)}},dependencies:[L,j,E,T,V,D,F,R],styles:[".main-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f5f5f5;display:flex;align-items:center;justify-content:center;padding:20px}.change-password-card[_ngcontent-%COMP%]{background:#fff;width:100%;max-width:800px;padding:40px;border-radius:10px;box-shadow:0 2px 6px #0000001a}.card-header[_ngcontent-%COMP%]{margin-bottom:30px;text-align:center}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;font-size:24px;font-weight:500;margin:0}.form-group[_ngcontent-%COMP%]{margin-bottom:25px}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#555;font-weight:500}.input-group[_ngcontent-%COMP%]{display:flex;align-items:center;border:1px solid #ddd;border-radius:5px;overflow:hidden}.input-group[_ngcontent-%COMP%]:focus-within{border-color:#007bff}.form-control[_ngcontent-%COMP%]{flex:1;padding:12px 15px;border:none;outline:none;font-size:16px}.toggle-password[_ngcontent-%COMP%]{padding:12px 15px;background:none;border:none;border-left:1px solid #ddd;cursor:pointer;color:#666}.toggle-password[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.security-notice[_ngcontent-%COMP%]{background-color:#f8f9fa;border-left:4px solid #007bff;padding:15px 20px;margin-bottom:30px}.security-notice[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;font-size:16px;margin-bottom:8px;font-weight:500}.security-notice[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;margin:0;font-size:14px;line-height:1.5}.btn-container[_ngcontent-%COMP%]{margin-top:30px}.btn-submit[_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#007bff;color:#fff;border:none;border-radius:5px;font-size:16px;font-weight:500;cursor:pointer;transition:background-color .2s}.btn-submit[_ngcontent-%COMP%]:hover{background-color:#0056b3}.btn-submit[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.alert[_ngcontent-%COMP%]{margin-top:20px;padding:12px 15px;border-radius:5px;font-size:14px}.alert-danger[_ngcontent-%COMP%]{background-color:#fff2f2;border:1px solid #ffcdd2;color:#d32f2f}.alert-success[_ngcontent-%COMP%]{background-color:#f1f8e9;border:1px solid #dcedc8;color:#689f38}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}@media (max-width: 768px){.change-password-card[_ngcontent-%COMP%]{padding:20px}.card-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:20px}.form-control[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{font-size:14px}}"]})};var W=class e{constructor(o,n){this.authService=o;this.router=n}canActivate(o){return this.authService.forcePasswordChange&&!o.routeConfig?.path?.includes("changepwd")?(this.router.navigate(["/admin/changepwd"]),!1):!0}static \u0275fac=function(n){return new(n||e)(J(f),J(P))};static \u0275prov=O({token:e,factory:e.\u0275fac,providedIn:"root"})};var _e=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:H},{path:"changepwd",component:z,canActivate:[W]},{path:"admin",loadChildren:()=>import("./chunk-IVR23BZJ.js").then(e=>e.AdminModule)}],B=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=k({type:e});static \u0275inj=I({imports:[Z.forRoot(_e),Z]})};var q=class e{title="smartv";static \u0275fac=function(n){return new(n||e)};static \u0275cmp=b({type:e,selectors:[["app-root"]],standalone:!1,decls:1,vars:0,template:function(n,t){n&1&&g(0,"router-outlet")},dependencies:[re],encapsulation:2})};var G=class e{intercept(o,n){let t=null;return typeof window<"u"&&window.sessionStorage&&(t=sessionStorage.getItem("authToken")),t&&(o=o.clone({setHeaders:{Authorization:`Bearer ${t}`}})),n.handle(o)}static \u0275fac=function(n){return new(n||e)};static \u0275prov=O({token:e,factory:e.\u0275fac,providedIn:"root"})};var ve={url:ie.baseUrl,options:{transports:["websocket"],autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}},U=class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=k({type:e,bootstrap:[q]});static \u0275inj=I({providers:[X($()),oe(ne()),se,f,{provide:Q,useClass:G,multi:!0}],imports:[te,B,ae,de.forRoot(ve),pe]})};ee().bootstrapModule(U,{ngZoneEventCoalescing:!0}).catch(e=>console.error(e));
